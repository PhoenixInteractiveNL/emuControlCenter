<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<!-- Mirrored from www.autoitscript.com/autoit3/docs/functions/InetGet.htm by HTTrack Website Copier/3.x [XR&CO'2006], Mon, 21 May 2007 15:28:56 GMT -->
<head>
  <title>Function InetGet</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <link href="../css/default.css" rel="stylesheet" type="text/css">
</head>

<body>
<h1>Function Reference</h1>
<font size="+1">InetGet</font>
<hr size="2">
<p>Downloads a file from the internet using the http or ftp protocol.<br></p>

<p class="codeheader">
InetGet ( "URL" [,"filename" [, reload [, background]]] )<br>
</p>
<p>&nbsp;</p>

<p><b>Parameters</b></p>
<table border="1" width="100%" cellspacing="0" cellpadding="3" bordercolor="#C0C0C0">
  <tr>
    <td width="15%">URL</td>
    <td width="85%">URL of the file to download.  See remarks below. Can be "abort".</td>
  </tr>
  <tr>
   <td>filename</td>
   <td>[optional]<br>
       Local filename to download to.</td>
  </tr>
  <tr>
   <td>reload</td>
   <td>[optional]<br>
       0 = (default) Get the file from local cache if available<br>
       1 = Forces a reload from the remote site</td>
  </tr>
  <tr>
   <td>background</td>
   <td>[optional]<br>
       0 = (default) Wait until the download is complete before continuing.<br>
       1 = return immediately and download in the background (see remarks).</td>
  </tr>
</table>
<p>&nbsp;</p>

<p><b>Return Value</b></p>
<table width="100%">
  <tr>
    <td width="10%" valign="top">Success:</td>
    <td width="90%">Returns 1.</td>
  </tr>
  <tr>
    <td valign="top">Failure:</td>
    <td>Returns 0.</td>
  </tr>
</table>
<p>&nbsp;</p>

<p><b>Remarks</b></p>
Internet Explorer 3 or greater must be installed for this function to work.<br>
<br>
The URL parameter should be in the form "http://www.somesite.com/path/file.html" - just like an address you would type into your web browser.<br>
<br>
To use a username and password when connecting simply prefix the servername with "username:password@", e.g.<br>
"http://myuser:mypassword@www.somesite.com"<br>
<br>
The InetGet function works with http:// https:// and ftp:// - to change the transfer type when using ftp see the FtpBinaryMode option.<br>
<br>
<b>&quot;background&quot; Parameter</b><br>
<br>
By default the function waits until the download has finished before returning.  Sometimes with large downloads this is not always wanted.  If the <b>background</b> parameter is set to 1 the function returns immediately and the download continues in the background.  When in this mode two macros are used to keep track:<br>
@InetGetActive = 1 while downloading, or 0 when finished.<br>
@InetGetBytesRead = the number of bytes downloaded, or -1 if there has been an error.<br>
<br>
Note, only one download can be active at once, if you call the function again before a download is complete it will fail.<br>
<br>
To abort a download call the function with just the first parameter set to "abort" like so:<br>
<p class="codebox">InetGet("abort")</p><br>
<br>
<p>&nbsp;</p>

<p><b>Related</b></p>
<a href="AutoItSetOption.html#FtpBinaryMode">FtpBinaryMode (Option)</a>, <a href="FtpSetProxy.html">FtpSetProxy</a>, <a href="InetGetSize.html">InetGetSize</a>, <a href="HttpSetProxy.html">HttpSetProxy</a>
<p>&nbsp;</p>

<p><b>Example</b></p>
<p class="codebox">
<br>
<span><span class="S4">InetGet</span><span class="S8">(</span><span class="S7">"http://www.mozilla.org"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"C:\foo.html"</span><span class="S8">)</span><br>
<span class="S4">InetGet</span><span class="S8">(</span><span class="S7">"http://www.autoitscript.com"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"C:\mydownload.htm"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">1</span><span class="S8">)</span><br>
<span class="S4">InetGet</span><span class="S8">(</span><span class="S7">"ftp://ftp.mozilla.org/pub/mozilla.org/README"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"README.txt"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">1</span><span class="S8">)</span><br>
<br>
<br>
<span class="S1">; Advanced example - downloading in the background</span><br>
<span class="S4">InetGet</span><span class="S8">(</span><span class="S7">"http://www.nowhere.com/somelargefile.exe"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"test.exe"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">1</span><span class="S8">)</span><br>
<br>
<span class="S5">While</span><span class="S0"> </span><span class="S6">@InetGetActive</span><br>
<span class="S0">&nbsp;&nbsp;</span><span class="S4">TrayTip</span><span class="S8">(</span><span class="S7">"Downloading"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Bytes = "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@InetGetBytesRead</span><span class="S8">,</span><span class="S0"> </span><span class="S3">10</span><span class="S8">,</span><span class="S0"> </span><span class="S3">16</span><span class="S8">)</span><br>
<span class="S0">&nbsp;&nbsp;</span><span class="S4">Sleep</span><span class="S8">(</span><span class="S3">250</span><span class="S8">)</span><br>
<span class="S5">Wend</span><br>
<br>
<span class="S4">MsgBox</span><span class="S8">(</span><span class="S3">0</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Bytes read"</span><span class="S8">,</span><span class="S0"> </span><span class="S6">@InetGetBytesRead</span><span class="S8">)</span><br>
<span class="S0"></span></span><br>
<p>&nbsp;</p>

</body>

<!-- Mirrored from www.autoitscript.com/autoit3/docs/functions/InetGet.htm by HTTrack Website Copier/3.x [XR&CO'2006], Mon, 21 May 2007 15:28:56 GMT -->
</html>
