<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<!-- Mirrored from www.autoitscript.com/autoit3/docs/functions/IniWriteSection.htm by HTTrack Website Copier/3.x [XR&CO'2006], Mon, 21 May 2007 15:29:00 GMT -->
<head>
  <title>Function IniWriteSection</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <link href="../css/default.css" rel="stylesheet" type="text/css">
</head>

<body>
<h1>Function Reference</h1>
<font size="+1">IniWriteSection</font>
<hr size="2">
<p>Writes a section to a standard format .ini file.<br></p>

<p class="codeheader">
IniWriteSection ( "filename", "section", "data" [, index ] )<br>
</p>
<p>&nbsp;</p>

<p><b>Parameters</b></p>
<table border="1" width="100%" cellspacing="0" cellpadding="3" bordercolor="#C0C0C0">
  <tr>
    <td width="15%">filename</td>
    <td width="85%">The filename of the .ini file.</td>
  </tr>
  <tr>
   <td>section</td>
   <td>The section name in the .ini file.</td>
  </tr>
  <tr>
   <td>data</td>
   <td>The data to write.  The data can either be a string or an array.  If the data is a string, then each key=value pair must be delimited by @LF.  If the data is an array, the array must be 2-dimensional and the second dimension must be 2 elements.</td>
  </tr>
  <tr>
   <td>index</td>
   <td>If an array is passed as data, this specifies the index to start writing from.  By default, this is 1 so that the return value of IniReadSection() can be used immediately.  For manually created arrays, this value may need to be different depending on how the array was created.  This parameter is ignored if a string is passed as data.</td>
  </tr>
</table>
<p>&nbsp;</p>

<p><b>Return Value</b></p>
<table width="100%">
  <tr>
    <td width="10%" valign="top">Success:</td>
    <td width="90%">Returns 1.</td>
  </tr>
  <tr>
    <td valign="top">Failure:</td>
    <td>Returns 0. The function will set @error to 1 if the data format is invalid.</td>
  </tr>
</table>
<p>&nbsp;</p>

<p><b>Remarks</b></p>
A standard ini file looks like:<br>
<i>[SectionName]<br>
Key=Value</i><br>
If file does not exist, it is created.  Keys and/or sections are added to the end and are not sorted in any way.<br>
<br>
If the section being written already exists, it's contents will be overwritten.<br>
<br>
<p>&nbsp;</p>

<p><b>Related</b></p>
<a href="IniDelete.html">IniDelete</a>, <a href="IniRead.html">IniRead</a>, <a href="FileWriteLine.html">FileWriteLine</a>, <a href="IniReadSection.html">IniReadSection</a>, <a href="IniReadSectionNames.html">IniReadSectionNames</a>, <a href="IniWrite.html">IniWrite</a>
<p>&nbsp;</p>

<p><b>Example</b></p>
<p class="codebox">
<br>
<span><span class="S1">; This is the INI file we will write to. &nbsp;It will be created on the Desktop.</span><br>
<span class="S9">$sIni</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S6">@DesktopDir</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">"\AutoIt-Test.ini"</span><br>
<br>
<span class="S1">; Demonstrate creating a new section using a string as input.</span><br>
<span class="S9">$sData</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">"Key1=Value1"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@LF</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">"Key2=Value2"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@LF</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">"Key3=Value3"</span><br>
<span class="S4">IniWriteSection</span><span class="S8">(</span><span class="S9">$sIni</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Section1"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$sData</span><span class="S8">)</span><br>
<br>
<span class="S1">; Demonstrate creating a new section using an array as input.</span><br>
<span class="S9">$aData1</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">IniReadSection</span><span class="S8">(</span><span class="S9">$sIni</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Section1"</span><span class="S8">)</span><span class="S0">&nbsp;</span><span class="S1">; Read in what we just wrote above.</span><br>
<span class="S5">For</span><span class="S0"> </span><span class="S9">$i</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">1</span><span class="S0"> </span><span class="S5">To</span><span class="S0"> </span><span class="S4">UBound</span><span class="S8">(</span><span class="S9">$aData1</span><span class="S8">)</span><span class="S0"> </span><span class="S8">-</span><span class="S0"> </span><span class="S3">1</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$aData1</span><span class="S8">[</span><span class="S9">$i</span><span class="S8">][</span><span class="S3">1</span><span class="S8">]</span><span class="S0"> </span><span class="S8">&amp;=</span><span class="S0"> </span><span class="S7">"-"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$i</span><span class="S0">&nbsp; </span><span class="S1">; Change the data some</span><br>
<span class="S5">Next</span><br>
<br>
<span class="S4">IniWriteSection</span><span class="S8">(</span><span class="S9">$sIni</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Section2"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$aData1</span><span class="S8">)</span><span class="S0">&nbsp;</span><span class="S1">; Write to a new section.</span><br>
<br>
<span class="S1">; Demonstrate creating an array manually and using it as input.</span><br>
<span class="S5">Dim</span><span class="S0"> </span><span class="S9">$aData2</span><span class="S8">[</span><span class="S3">3</span><span class="S8">][</span><span class="S3">2</span><span class="S8">]</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S8">[</span><span class="S0"> </span><span class="S8">[</span><span class="S0"> </span><span class="S7">"FirstKey"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"FirstValue"</span><span class="S0"> </span><span class="S8">],</span><span class="S0"> </span><span class="S8">[</span><span class="S0"> </span><span class="S7">"SecondKey"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"SecondValue"</span><span class="S0"> </span><span class="S8">],</span><span class="S0"> </span><span class="S8">[</span><span class="S0"> </span><span class="S7">"ThirdKey"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"ThirdValue"</span><span class="S0"> </span><span class="S8">]</span><span class="S0"> </span><span class="S8">]</span><br>
<span class="S1">; Since the array we made starts at element 0, we need to tell IniWriteSection() to start writing from element 0.</span><br>
<span class="S4">IniWriteSection</span><span class="S8">(</span><span class="S9">$sIni</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Section3"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$aData2</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0</span><span class="S8">)</span><br>
<span class="S0"></span></span><br>
<p>&nbsp;</p>

</body>

<!-- Mirrored from www.autoitscript.com/autoit3/docs/functions/IniWriteSection.htm by HTTrack Website Copier/3.x [XR&CO'2006], Mon, 21 May 2007 15:29:00 GMT -->
</html>
