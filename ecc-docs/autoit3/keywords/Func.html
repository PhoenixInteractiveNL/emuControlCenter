<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<!-- Mirrored from www.autoitscript.com/autoit3/docs/keywords/Func.htm by HTTrack Website Copier/3.x [XR&CO'2006], Mon, 21 May 2007 15:28:56 GMT -->
<head>
  <title>Keyword Func...Return...EndFunc</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <link href="../css/default.css" rel="stylesheet" type="text/css">
</head>

<body>
<h1>Keyword Reference</h1>
<font size="+1">Func...Return...EndFunc</font>
<hr size="2">
<p>Defines a user-defined function that takes zero or more arguments and optionally returns a result.<br></p>

<p class="codeheader">
<b>Func</b> functioname ( [<b>Const</b>] [<b>ByRef</b>] $param1, ..., [<b>Const</b>] [<b>ByRef</b>] $paramN, $optionalpar1 = value, ...)<br>
&nbsp;&nbsp;&nbsp; ...<br>
&nbsp;&nbsp;&nbsp; [<b>Return</b> [<i>value</i>]]<br>
<b>EndFunc</b><br>
</p>
<p>&nbsp;</p>

<p><b>Parameters</b></p>
The parameters are set by you.  You later call the function like any other built-in function.<br>
<p>&nbsp;</p>

<p><b>Remarks</b></p>
The Const keyword is optional and indicates that the value of the parameter will not change during the execution of the function.  A variable declared Const can only be passed to a function using a Const parameter.<br>
<br>
The ByRef keyword is optional and means: (1) the parameter must a variable, and (2) the original variable is linked to the parameter, so that any changes to the parameter inside the function, would affect the original variable as well. By default, a parameter is <i>passed by value</i> which means that a copy of the parameter's value, is manipulated by the function.<br>
<br>
The order of the ByRef and Const keywords is not important, so long as they are in front of the variable they modify.<br>
<br>
Arrays can be passed to functions (and returned from them) by simply using the array name without any brackets.  Arrays should be passed to user-defined functions using the ByRef keyword to avoid copying all the data in the array.<br>
<br>
Optional parameters are defined by assigning a default value to them, which could be a macro.  They are always the last in the definition.  If a parameter is given a default value, then all parameters after that one must also be given default values.  Inside the function, the number of parameters given when the function was called can be retrieved with the @NUMPARAMS macro.<br>
<br>
Use the Return keyword to exit the function.  Unlike built-in functions, user-defined functions return 0 unless another return value is specified.<br>
<br>
Note that function declarations cannot appear inside other function declarations.  <br>
<br>
<p>&nbsp;</p>

<p><b>Related</b></p>
<a href="Dim.html">Dim/Global/Local</a>, <a href="include.html">#include</a>, <a href="Dim.html">Const</a>
<p>&nbsp;</p>

<p><b>Example</b></p>
<p class="codebox">
<br>
<span><span class="S1">; Sample script with three user-defined functions</span><br>
<span class="S1">; Notice the use of variables, ByRef, and Return</span><br>
<br>
<span class="S9">$foo</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">2</span><br>
<span class="S9">$bar</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">5</span><br>
<span class="S4">msgBox</span><span class="S8">(</span><span class="S3">0</span><span class="S8">,</span><span class="S7">"Today is "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> today</span><span class="S8">(),</span><span class="S0"> </span><span class="S7">"$foo equals "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$foo</span><span class="S8">)</span><br>
<span class="S0">swap</span><span class="S8">(</span><span class="S9">$foo</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$bar</span><span class="S8">)</span><br>
<span class="S4">msgBox</span><span class="S8">(</span><span class="S3">0</span><span class="S8">,</span><span class="S7">"After swapping $foo and $bar"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"$foo now contains "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$foo</span><span class="S8">)</span><br>
<span class="S4">msgBox</span><span class="S8">(</span><span class="S3">0</span><span class="S8">,</span><span class="S7">"Finally"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"The larger of 3 and 4 is "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> max</span><span class="S8">(</span><span class="S3">3</span><span class="S8">,</span><span class="S3">4</span><span class="S8">))</span><br>
<span class="S5">Exit</span><br>
<br>
<span class="S5">Func</span><span class="S0"> swap</span><span class="S8">(</span><span class="S5">ByRef</span><span class="S0"> </span><span class="S9">$a</span><span class="S8">,</span><span class="S0"> </span><span class="S5">ByRef</span><span class="S0"> </span><span class="S9">$b</span><span class="S8">)</span><span class="S0"> &nbsp;</span><span class="S1">;swap the contents of two variables</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$t</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$t</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$a</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$a</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$b</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$b</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$t</span><br>
<span class="S5">EndFunc</span><br>
<br>
<span class="S5">Func</span><span class="S0"> today</span><span class="S8">()</span><span class="S0"> &nbsp;</span><span class="S1">;Return the current date in mm/dd/yyyy form</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">return</span><span class="S0"> </span><span class="S8">(</span><span class="S6">@MON</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">"/"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@MDAY</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">"/"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@YEAR</span><span class="S8">)</span><br>
<span class="S5">EndFunc</span><br>
<br>
<span class="S5">Func</span><span class="S0"> max</span><span class="S8">(</span><span class="S9">$x</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$y</span><span class="S8">)</span><span class="S0"> &nbsp;</span><span class="S1">;Return the larger of two numbers</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$x</span><span class="S0"> </span><span class="S8">&gt;</span><span class="S0"> </span><span class="S9">$y</span><span class="S0"> </span><span class="S5">Then</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">return</span><span class="S0"> </span><span class="S9">$x</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Else</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">return</span><span class="S0"> </span><span class="S9">$y</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br>
<span class="S5">EndFunc</span><br>
<br>
<span class="S1">;End of sample script</span><br>
<span class="S0"></span></span><br>
<p>&nbsp;</p>

</body>

<!-- Mirrored from www.autoitscript.com/autoit3/docs/keywords/Func.htm by HTTrack Website Copier/3.x [XR&CO'2006], Mon, 21 May 2007 15:28:56 GMT -->
</html>
