<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<!-- Mirrored from www.autoitscript.com/autoit3/docs/functions/GUIRegisterMsg.htm by HTTrack Website Copier/3.x [XR&CO'2006], Mon, 21 May 2007 15:28:59 GMT -->
<head>
  <title>Function GUIRegisterMsg</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <link href="../css/default.css" rel="stylesheet" type="text/css">
</head>

<body>
<h1>Function Reference</h1>
<font size="+1">GUIRegisterMsg</font>
<hr size="2">
<p>Register a user defined function for a known Windows Message ID (WM_MSG).<br></p>

<p class="codeheader">
GUIRegisterMsg ( msgID, "function" )<br>
</p>
<p>&nbsp;</p>

<p><b>Parameters</b></p>
<table border="1" width="100%" cellspacing="0" cellpadding="3" bordercolor="#C0C0C0">
  <tr>
    <td width="15%">msgID</td>
    <td width="85%">A Windows Message ID (see Appendix: <a href="../appendix/WinMsgCodes.html">Windows Message Codes</a>).</td>
  </tr>
  <tr>
   <td>function</td>
   <td>The name of the user function to call when the message appears or an empty string "" to unregister a message.</td>
  </tr>
</table>
<p>&nbsp;</p>

<p><b>Return Value</b></p>
<table width="100%">
  <tr>
    <td width="10%" valign="top">Success:</td>
    <td width="90%">1</td>
  </tr>
  <tr>
    <td valign="top">Failure:</td>
    <td>0</td>
  </tr>
</table>
<p>&nbsp;</p>

<p><b>Remarks</b></p>
!!! To make the user function workable you have to define it with <strong>maximum 4 function parameters</strong> otherwise the function won't be called !!!<br>
i.e:<br>
Func MyUserFunction($hWndGUI, $MsgID, $WParam, $LParam)<br>
...<br>
EndFunc<br>
<br>
Or<br>
<br>
Func MyUserFunction($hWndGUI, $MsgID)<br>
...<br>
EndFunc<br>
<br>
When the user function is called then these 4 parameters have the following values:<br>
<table width="100%" border="1" cellspacing="0" cellpadding="3" bordercolor="#C0C0C0">
  <tr>
    <td style="border-bottom-style: solid; border-bottom-width: 1"><b>Position</b></td>
    <td style="border-bottom-style: solid; border-bottom-width: 1"><b>Parameter</b></td>
    <td style="border-bottom-style: solid; border-bottom-width: 1"><b>Meaning</b></td>
  </tr>
  <tr>
    <td>1</td>
    <td>hWnd</td>
    <td>The Window handle of the GUI in which the message appears.</td>
  </tr>
  <tr>
    <td>2</td>
    <td>Msg</td>
    <td>The Windows message ID.</td>
  </tr>
  <tr>
    <td>3</td>
    <td>wParam</td>
    <td>The first message parameter as hex value.</td>
  </tr>
  <tr>
    <td>4</td>
    <td>lParam</td>
    <td>The second message parameter as hex value.</td>
  </tr>
</table><br>
Up to 256 user functions can be registered for message ID's.<br>
<br>
By default after finishing the user function the AutoIt internal message handler will be proceed.<br>
That won't be if your <strong>Return</strong> a value (See WM_COMMAND in example) or if you use the keyword 'Return' without any value.<br>
By using 'Return' without any return value the AutoIt internal message handler (if there is one for this message) will NOT be proceed!<br>
<br>
!!! If you want AutoIt to run it's internal handler for a message, return the variable <strong>$GUI_RUNDEFMSG</strong> (in GUIConstants.au3) from the function (see also examples) !!!<br>
I.e. if you want to return earlier than the user function ends and also proceed the AutoIt internal message handler.<br>
<br>
<strong>Warning:</strong> blocking of running user functions which executes window messages with commands such as "Msgbox()" can lead to unexpected behavior, the return to the system should be as fast as possible !!!<br>
<br>
Some controls consume internally specific Windows Message ID, so registrating them will have no effect, e.g; WM_CHAR, WM_KEYDOWN, WM_KEYUP are consumed by an edit control.<br>
<br>
<p>&nbsp;</p>

<p><b>Related</b></p>
<a href="GUICtrlGetHandle.html">GUICtrlGetHandle</a>
<p>&nbsp;</p>

<p><b>Example</b></p>
<p class="codebox">
<br>
<span><span class="S1">; *******************************************************</span><br>
<span class="S1">; Example - Create an ownerdrawn/colored button</span><br>
<span class="S1">; *******************************************************</span><br>
<br>
<span class="S11">#include</span><span class="S0"> </span><span class="S7">&lt;GUIConstants.au3&gt;</span><br>
<br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$WM_DRAWITEM</span><span class="S0">&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0x002B</span><br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$WM_COMMAND</span><span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0x0111</span><br>
<br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$GWL_STYLE</span><span class="S0"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S8">-</span><span class="S3">16</span><br>
<br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$BS_OWNERDRAW</span><span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0x0000000B</span><br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$BS_NOTIFY</span><span class="S0">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0x00004000</span><br>
<br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$COLOR_BTNTEXT</span><span class="S0">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S3">18</span><br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$COLOR_BTNFACE</span><span class="S0">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S3">15</span><br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$COLOR_BTNSHADOW</span><span class="S0">&nbsp; &nbsp;&nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S3">16</span><br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$COLOR_HIGHLIGHTTEXT</span><span class="S0">&nbsp; &nbsp;</span><span class="S8">=</span><span class="S0"> </span><span class="S3">14</span><br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$COLOR_GRAYTEXT</span><span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S3">17</span><br>
<br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$DT_CENTER</span><span class="S0">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0x00000001</span><br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$DT_RIGHT</span><span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0x00000002</span><br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$DT_VCENTER</span><span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0x00000004</span><br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$DT_BOTTOM</span><span class="S0">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0x00000008</span><br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$DT_WORDBREAK</span><span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0x00000010</span><br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$DT_SINGLELINE</span><span class="S0">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0x00000020</span><br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$DT_EXPANDTABS</span><span class="S0">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0x00000040</span><br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$DT_TABSTOP</span><span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0x00000080</span><br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$DT_NOCLIP</span><span class="S0">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0x00000100</span><br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$DT_EXTERNALLEADING</span><span class="S0">&nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0x00000200</span><br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$DT_CALCRECT</span><span class="S0">&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0x00000400</span><br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$DT_NOPREFIX</span><span class="S0">&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0x00000800</span><br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$DT_INTERNAL</span><span class="S0">&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0x00001000</span><br>
<br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$ODS_SELECTED</span><span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0x0001</span><br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$ODS_GRAYED</span><span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0x0002</span><br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$ODS_DISABLED</span><span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0x0004</span><br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$ODS_CHECKED</span><span class="S0">&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0x0008</span><br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$ODS_FOCUS</span><span class="S0">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0x0010</span><br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$ODS_HOTLIGHT</span><span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0x0040</span><br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$ODS_INACTIVE</span><span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0x0080</span><br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$ODS_NOACCEL</span><span class="S0">&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0x0100</span><br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$ODS_NOFOCUSRECT</span><span class="S0">&nbsp; &nbsp;&nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0x0200</span><br>
<br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$ODT_BUTTON</span><span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S3">4</span><br>
<br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$DFC_BUTTON</span><span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S3">4</span><br>
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$DFCS_BUTTONPUSH</span><span class="S0">&nbsp; &nbsp;&nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0x0010</span><br>
<br>
<br>
<span class="S9">$hGUI</span><span class="S0">&nbsp; &nbsp;&nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICreate</span><span class="S8">(</span><span class="S7">"My Ownerdrawn Created Button"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">300</span><span class="S8">,</span><span class="S0"> </span><span class="S3">200</span><span class="S8">)</span><br>
<br>
<span class="S9">$nButton</span><span class="S0">&nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateButton</span><span class="S8">(</span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S3">90</span><span class="S8">,</span><span class="S0"> </span><span class="S3">50</span><span class="S8">,</span><span class="S0"> </span><span class="S3">120</span><span class="S8">,</span><span class="S0"> </span><span class="S3">30</span><span class="S8">)</span><br>
<span class="S4">GUICtrlSetStyle</span><span class="S8">(</span><span class="S9">$nButton</span><span class="S8">,</span><span class="S0"> </span><span class="S4">BitOr</span><span class="S8">(</span><span class="S9">$WS_TABSTOP</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$BS_NOTIFY</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$BS_OWNERDRAW</span><span class="S8">))</span><span class="S0"> </span><span class="S1">; Set the ownerdrawn flag</span><br>
<br>
<span class="S9">$nButton2</span><span class="S0">&nbsp; &nbsp;</span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateButton</span><span class="S8">(</span><span class="S7">"Normal Button"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">90</span><span class="S8">,</span><span class="S0"> </span><span class="S3">110</span><span class="S8">,</span><span class="S0"> </span><span class="S3">120</span><span class="S8">,</span><span class="S0"> </span><span class="S3">30</span><span class="S8">)</span><br>
<br>
<span class="S4">GUIRegisterMsg</span><span class="S8">(</span><span class="S9">$WM_COMMAND</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"MY_WM_COMMAND"</span><span class="S8">)</span><br>
<span class="S1">; WM_DRAWITEM has to registered before showing GUI otherwise the initial drawing isn't done</span><br>
<span class="S4">GUIRegisterMsg</span><span class="S8">(</span><span class="S9">$WM_DRAWITEM</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"MY_WM_DRAWITEM"</span><span class="S8">)</span><br>
<br>
<span class="S4">GUISetState</span><span class="S8">()</span><br>
<br>
<span class="S5">While</span><span class="S0"> </span><span class="S3">1</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$GUIMsg</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUIGetMsg</span><span class="S8">()</span><br>
<span class="S0">&nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Switch</span><span class="S0"> </span><span class="S9">$GUIMsg</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Case</span><span class="S0"> </span><span class="S9">$GUI_EVENT_CLOSE</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">ExitLoop</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Case</span><span class="S0"> </span><span class="S9">$nButton</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S1">; Normally should not run through cause of our MY_WM_COMMAND function</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">Msgbox</span><span class="S8">(</span><span class="S3">0</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Info"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Button pressed"</span><span class="S8">)</span><span class="S0"> </span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Case</span><span class="S0"> </span><span class="S9">$nButton2</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S1">; Normally should not run through cause of our MY_WM_COMMAND function</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">Msgbox</span><span class="S8">(</span><span class="S3">0</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Info"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Button2 pressed"</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndSwitch</span><br>
<span class="S5">WEnd</span><br>
<br>
<span class="S5">Exit</span><br>
<br>
<br>
<span class="S1">; React on a button click</span><br>
<span class="S5">Func</span><span class="S0"> MY_WM_COMMAND</span><span class="S8">(</span><span class="S9">$hWnd</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$Msg</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$wParam</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$lParam</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$nNotifyCode</span><span class="S0">&nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S4">BitShift</span><span class="S8">(</span><span class="S9">$wParam</span><span class="S8">,</span><span class="S0"> </span><span class="S3">16</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$nID</span><span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S4">BitAnd</span><span class="S8">(</span><span class="S9">$wParam</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0x0000FFFF</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$hCtrl</span><span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$lParam</span><br>
<span class="S0">&nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$nID</span><span class="S0"> </span><span class="S8">&lt;&gt;</span><span class="S0"> </span><span class="S3">2</span><span class="S0"> </span><span class="S5">And</span><span class="S0"> </span><span class="S9">$nNotifyCode</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> </span><span class="S1">; Check for IDCANCEL - 2</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S1">; Ownerdrawn buttons don't send something by pressing ENTER</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S1">; So IDOK - 1 comes up, now check for the control that has the current focus</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$nID</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">1</span><span class="S0"> </span><span class="S5">Then</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$hFocus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllCall</span><span class="S8">(</span><span class="S7">"user32.dll"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"hwnd"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"GetFocus"</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$nCtrlID</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllCall</span><span class="S8">(</span><span class="S7">"user32.dll"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"int"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"GetDlgCtrlID"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"hwnd"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$hFocus</span><span class="S8">[</span><span class="S3">0</span><span class="S8">])</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PostButtonClick</span><span class="S8">(</span><span class="S9">$hFocus</span><span class="S8">[</span><span class="S3">0</span><span class="S8">],</span><span class="S0"> </span><span class="S9">$nCtrlID</span><span class="S8">[</span><span class="S3">0</span><span class="S8">])</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Else</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">Msgbox</span><span class="S8">(</span><span class="S3">0</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"MY_WM_COMMAND"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"GUIHWnd"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@TAB</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">":"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$hwnd</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@LF</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S8">_</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S7">"MsgID"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@TAB</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">":"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$Msg</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@LF</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S8">_</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S7">"wParam"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@TAB</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">":"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$wParam</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@LF</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S8">_</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S7">"lParam"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@TAB</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">":"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$lParam</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@LF</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@LF</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S8">_</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S7">"WM_COMMAND - Infos:"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@LF</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S8">_</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S7">"-----------------------------"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@LF</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S8">_</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S7">"Code"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@TAB</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">":"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$nNotifyCode</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@LF</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S8">_</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S7">"CtrlID"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@TAB</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">":"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$nID</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@LF</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S8">_</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S7">"CtrlHWnd"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@TAB</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">":"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$hCtrl</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S1">; Only workout clicking on the button</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Proceed the default Autoit3 internal message commands.</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; You also can complete let the line out.</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; !!! But only 'Return' (without any value) will not proceed</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; the default Autoit3-message in the future !!!</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S9">$GUI_RUNDEFMSG</span><br>
<span class="S5">EndFunc</span><br>
<br>
<br>
<span class="S1">; RePost a WM_COMMAND message to a ctrl in a gui window</span><br>
<span class="S5">Func</span><span class="S0"> PostButtonClick</span><span class="S8">(</span><span class="S9">$hWnd</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nCtrlID</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllCall</span><span class="S8">(</span><span class="S7">"user32.dll"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"int"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"PostMessage"</span><span class="S8">,</span><span class="S0"> </span><span class="S8">_</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S7">"hwnd"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$hGUI</span><span class="S8">,</span><span class="S0"> </span><span class="S8">_</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S7">"int"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$WM_COMMAND</span><span class="S8">,</span><span class="S0"> </span><span class="S8">_</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S7">"int"</span><span class="S8">,</span><span class="S0"> </span><span class="S4">BitAnd</span><span class="S8">(</span><span class="S9">$nCtrlID</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0x0000FFFF</span><span class="S8">),</span><span class="S0"> </span><span class="S8">_</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S7">"hwnd"</span><span class="S8">,</span><span class="S0"> </span><span class="S4">GUICtrlGetHandle</span><span class="S8">(</span><span class="S9">$nCtrlid</span><span class="S8">))</span><br>
<span class="S5">EndFunc</span><br>
<br>
<br>
<span class="S1">; Draw the button</span><br>
<span class="S5">Func</span><span class="S0"> MY_WM_DRAWITEM</span><span class="S8">(</span><span class="S9">$hWnd</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$Msg</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$wParam</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$lParam</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$stDrawItem</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllStructCreate</span><span class="S8">(</span><span class="S7">"uint;uint;uint;uint;uint;uint;uint;int[4];dword"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$lParam</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$nCtlType</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllStructGetData</span><span class="S8">(</span><span class="S9">$stDrawItem</span><span class="S8">,</span><span class="S0"> </span><span class="S3">1</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$nCtlType</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$ODT_BUTTON</span><span class="S0"> </span><span class="S5">Then</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$nCtrlID</span><span class="S0">&nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllStructGetData</span><span class="S8">(</span><span class="S9">$stDrawItem</span><span class="S8">,</span><span class="S0"> </span><span class="S3">2</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$nItemState</span><span class="S0">&nbsp;</span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllStructGetData</span><span class="S8">(</span><span class="S9">$stDrawItem</span><span class="S8">,</span><span class="S0"> </span><span class="S3">5</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$hCtrl</span><span class="S0">&nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllStructGetData</span><span class="S8">(</span><span class="S9">$stDrawItem</span><span class="S8">,</span><span class="S0"> </span><span class="S3">6</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$hDC</span><span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllStructGetData</span><span class="S8">(</span><span class="S9">$stDrawItem</span><span class="S8">,</span><span class="S0"> </span><span class="S3">7</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$nLeft</span><span class="S0">&nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllStructGetData</span><span class="S8">(</span><span class="S9">$stDrawItem</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8</span><span class="S8">,</span><span class="S0"> </span><span class="S3">1</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$nTop</span><span class="S0">&nbsp; &nbsp;&nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllStructGetData</span><span class="S8">(</span><span class="S9">$stDrawItem</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8</span><span class="S8">,</span><span class="S0"> </span><span class="S3">2</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$nRight</span><span class="S0">&nbsp;&nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllStructGetData</span><span class="S8">(</span><span class="S9">$stDrawItem</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8</span><span class="S8">,</span><span class="S0"> </span><span class="S3">3</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$nBottom</span><span class="S0">&nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllStructGetData</span><span class="S8">(</span><span class="S9">$stDrawItem</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8</span><span class="S8">,</span><span class="S0"> </span><span class="S3">4</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$sText</span><span class="S0">&nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S7">"Ownerdrawn Button"</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$nTextColor</span><span class="S0">&nbsp;</span><span class="S8">=</span><span class="S0"> </span><span class="S3">0x5555DD</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$nBackColor</span><span class="S0">&nbsp;</span><span class="S8">=</span><span class="S0"> </span><span class="S3">0xFFEEDD</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; DrawButton</span><span class="S8">(</span><span class="S9">$hWnd</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$hCtrl</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nLeft</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTop</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nRight</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nBottom</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nItemState</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$sText</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTextColor</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nBackColor</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$stDrawItem</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S3">1</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br>
<br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$stDrawItem</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S9">$GUI_RUNDEFMSG</span><span class="S0"> </span><span class="S1">; Proceed the default Autoit3 internal message commands</span><br>
<span class="S5">EndFunc</span><br>
<br>
<br>
<span class="S1">; The main drawing procedure</span><br>
<span class="S5">Func</span><span class="S0"> DrawButton</span><span class="S8">(</span><span class="S9">$hWnd</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$hCtrl</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nLeft</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTop</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nRight</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nBottom</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nItemState</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$sText</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTextColor</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nBackColor</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S1">;Local $bDefault&nbsp; &nbsp; = FALSE</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$bChecked</span><span class="S0">&nbsp;</span><span class="S8">=</span><span class="S0"> </span><span class="S4">BitAnd</span><span class="S8">(</span><span class="S9">$nItemState</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$ODS_CHECKED</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$bFocused</span><span class="S0">&nbsp;</span><span class="S8">=</span><span class="S0"> </span><span class="S4">BitAnd</span><span class="S8">(</span><span class="S9">$nItemState</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$ODS_FOCUS</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$bGrayed</span><span class="S0">&nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S4">BitAnd</span><span class="S8">(</span><span class="S9">$nItemState</span><span class="S8">,</span><span class="S0"> </span><span class="S4">BitOr</span><span class="S8">(</span><span class="S9">$ODS_GRAYED</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$ODS_DISABLED</span><span class="S8">))</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$bSelected</span><span class="S8">=</span><span class="S0"> </span><span class="S4">BitAnd</span><span class="S8">(</span><span class="S9">$nItemState</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$ODS_SELECTED</span><span class="S8">)</span><br>
<br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$stRect</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllStructCreate</span><span class="S8">(</span><span class="S7">"int;int;int;int"</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllStructSetData</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">,</span><span class="S0"> </span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nLeft</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllStructSetData</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">,</span><span class="S0"> </span><span class="S3">2</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTop</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllStructSetData</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">,</span><span class="S0"> </span><span class="S3">3</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nRight</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllStructSetData</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">,</span><span class="S0"> </span><span class="S3">4</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nBottom</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$bGrayed</span><span class="S0"> </span><span class="S5">Then</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$nClrTxt</span><span class="S0">&nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> SetTextColor</span><span class="S8">(</span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> GetSysColor</span><span class="S8">(</span><span class="S9">$COLOR_HIGHLIGHTTEXT</span><span class="S8">))</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">ElseIf</span><span class="S0"> </span><span class="S9">$nTextColor</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S8">-</span><span class="S3">1</span><span class="S0"> </span><span class="S5">Then</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$nClrTxt</span><span class="S0">&nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> SetTextColor</span><span class="S8">(</span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> GetSysColor</span><span class="S8">(</span><span class="S9">$COLOR_BTNTEXT</span><span class="S8">))</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Else</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$nClrTxt</span><span class="S0">&nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> SetTextColor</span><span class="S8">(</span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTextColor</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br>
<span class="S0">&nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$nBackColor</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S8">-</span><span class="S3">1</span><span class="S0"> </span><span class="S5">Then</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$hBrush</span><span class="S0">&nbsp;&nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> GetSysColorBrush</span><span class="S8">(</span><span class="S9">$COLOR_BTNFACE</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$nClrSel</span><span class="S0">&nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> GetSysColor</span><span class="S8">(</span><span class="S9">$COLOR_BTNFACE</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Else</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$hBrush</span><span class="S0">&nbsp;&nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> CreateSolidBrush</span><span class="S8">(</span><span class="S9">$nBackColor</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$nClrSel</span><span class="S0">&nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$nBackColor</span><span class="S1">;</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br>
<br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$nClrBk</span><span class="S0">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> SetBkColor</span><span class="S8">(</span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nClrSel</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$hOldBrush</span><span class="S0">&nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> SelectObject</span><span class="S8">(</span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$hBrush</span><span class="S8">)</span><br>
<br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$nTmpLeft</span><span class="S0">&nbsp; &nbsp;</span><span class="S8">=</span><span class="S0"> </span><span class="S9">$nLeft</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$nTmpTop</span><span class="S0">&nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$nTop</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$nTmpRight</span><span class="S0">&nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$nRight</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$nTmpBottom</span><span class="S0">&nbsp;</span><span class="S8">=</span><span class="S0"> </span><span class="S9">$nBottom</span><br>
<span class="S0">&nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$bSelected</span><span class="S0"> </span><span class="S5">Then</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; InflateRect</span><span class="S8">(</span><span class="S9">$nTmpLeft</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpTop</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpRight</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpBottom</span><span class="S8">,</span><span class="S0"> </span><span class="S8">-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S8">-</span><span class="S3">1</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$hBrushSel</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> CreateSolidBrush</span><span class="S8">(</span><span class="S0">GetSysColor</span><span class="S8">(</span><span class="S9">$COLOR_BTNSHADOW</span><span class="S8">))</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; FrameRect</span><span class="S8">(</span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpLeft</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpTop</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpRight</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpBottom</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$hBrushSel</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; DeleteObject</span><span class="S8">(</span><span class="S9">$hBrushSel</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Else</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$bFocused</span><span class="S0"> </span><span class="S5">And</span><span class="S0"> </span><span class="S5">Not</span><span class="S0"> </span><span class="S9">$bSelected</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> InflateRect</span><span class="S8">(</span><span class="S9">$nTmpLeft</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpTop</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpRight</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpBottom</span><span class="S8">,</span><span class="S0"> </span><span class="S8">-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S8">-</span><span class="S3">1</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; DrawFrameControl</span><span class="S8">(</span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpLeft</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpTop</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpRight</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpBottom</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$DFC_BUTTON</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$DFCS_BUTTONPUSH</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br>
<span class="S0">&nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$nTmpLeft</span><span class="S0">&nbsp; &nbsp;</span><span class="S8">=</span><span class="S0"> </span><span class="S9">$nLeft</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$nTmpTop</span><span class="S0">&nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$nTop</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$nTmpRight</span><span class="S0">&nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$nRight</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$nTmpBottom</span><span class="S0">&nbsp;</span><span class="S8">=</span><span class="S0"> </span><span class="S9">$nBottom</span><br>
<span class="S0">&nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$bSelected</span><span class="S0"> </span><span class="S5">Then</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; InflateRect</span><span class="S8">(</span><span class="S9">$nTmpLeft</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpTop</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpRight</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpBottom</span><span class="S8">,</span><span class="S0"> </span><span class="S8">-</span><span class="S3">2</span><span class="S8">,</span><span class="S0"> </span><span class="S8">-</span><span class="S3">2</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Else</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$bFocused</span><span class="S0"> </span><span class="S5">And</span><span class="S0"> </span><span class="S5">Not</span><span class="S0"> </span><span class="S9">$bSelected</span><span class="S0"> </span><span class="S5">Then</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; InflateRect</span><span class="S8">(</span><span class="S9">$nTmpLeft</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpTop</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpRight</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpBottom</span><span class="S8">,</span><span class="S0"> </span><span class="S8">-</span><span class="S3">3</span><span class="S8">,</span><span class="S0"> </span><span class="S8">-</span><span class="S3">3</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$nTmpLeft</span><span class="S0"> </span><span class="S8">-=</span><span class="S0"> </span><span class="S3">1</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$nTmpTop</span><span class="S0"> </span><span class="S8">-=</span><span class="S0"> </span><span class="S3">1</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Else</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; InflateRect</span><span class="S8">(</span><span class="S9">$nTmpLeft</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpTop</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpRight</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpBottom</span><span class="S8">,</span><span class="S0"> </span><span class="S8">-</span><span class="S3">2</span><span class="S8">,</span><span class="S0"> </span><span class="S8">-</span><span class="S3">2</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$nTmpLeft</span><span class="S0"> </span><span class="S8">-=</span><span class="S0"> </span><span class="S3">1</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$nTmpTop</span><span class="S0"> </span><span class="S8">-=</span><span class="S0"> </span><span class="S3">1</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br>
<span class="S0">&nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; FillRect</span><span class="S8">(</span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpLeft</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpTop</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpRight</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpBottom</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$hBrush</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$bSelected</span><span class="S0"> </span><span class="S5">Or</span><span class="S0"> </span><span class="S9">$bGrayed</span><span class="S0"> </span><span class="S5">Then</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$nTmpLeft</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$nTmpLeft</span><span class="S0"> </span><span class="S8">+</span><span class="S0"> </span><span class="S3">2</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$nTmpTop</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$nTmpTop</span><span class="S0"> </span><span class="S8">+</span><span class="S3">2</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br>
<span class="S0">&nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$uFlags</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">BitOr</span><span class="S8">(</span><span class="S9">$DT_NOCLIP</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$DT_CENTER</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$DT_VCENTER</span><span class="S8">)</span><br>
<br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S5">Not</span><span class="S0"> </span><span class="S4">BitAnd</span><span class="S8">(</span><span class="S0">GetWindowLong</span><span class="S8">(</span><span class="S9">$hCtrl</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$GWL_STYLE</span><span class="S8">),</span><span class="S0"> </span><span class="S9">$BS_MULTILINE</span><span class="S8">)</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> </span><span class="S9">$uFlags</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">BitOr</span><span class="S8">(</span><span class="S9">$uFlags</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$DT_SINGLELINE</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; DrawText</span><span class="S8">(</span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$sText</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpLeft</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpTop</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpRight</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpBottom</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$uFlags</span><span class="S8">)</span><br>
<br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$bGrayed</span><span class="S0"> </span><span class="S5">Then</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$nTmpLeft</span><span class="S0">&nbsp; &nbsp;</span><span class="S8">=</span><span class="S0"> </span><span class="S9">$nLeft</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$nTmpTop</span><span class="S0">&nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$nTop</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$nTmpRight</span><span class="S0">&nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$nRight</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$nTmpBottom</span><span class="S0">&nbsp;</span><span class="S8">=</span><span class="S0"> </span><span class="S9">$nBottom</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$nTmpLeft</span><span class="S0"> </span><span class="S8">-=</span><span class="S0"> </span><span class="S3">1</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$nClrTxt</span><span class="S0">&nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> SetTextColor</span><span class="S8">(</span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> GetSysColor</span><span class="S8">(</span><span class="S9">$COLOR_GRAYTEXT</span><span class="S8">))</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; DrawText</span><span class="S8">(</span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$sText</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpLeft</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpTop</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpRight</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpBottom</span><span class="S8">,</span><span class="S0"> </span><span class="S4">BitOr</span><span class="S8">(</span><span class="S9">$DT_NOCLIP</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$DT_CENTER</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$DT_VCENTER</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$DT_SINGLELINE</span><span class="S8">))</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br>
<br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$nTmpLeft</span><span class="S0">&nbsp; &nbsp;</span><span class="S8">=</span><span class="S0"> </span><span class="S9">$nLeft</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$nTmpTop</span><span class="S0">&nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$nTop</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$nTmpRight</span><span class="S0">&nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$nRight</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$nTmpBottom</span><span class="S0">&nbsp;</span><span class="S8">=</span><span class="S0"> </span><span class="S9">$nBottom</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$bFocused</span><span class="S0"> </span><span class="S5">Then</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$hBrush</span><span class="S0">&nbsp;</span><span class="S8">=</span><span class="S0"> CreateSolidBrush</span><span class="S8">(</span><span class="S3">0</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; FrameRect</span><span class="S8">(</span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpLeft</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpTop</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpRight</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpBottom</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$hBrush</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$nTmpLeft</span><span class="S0">&nbsp; &nbsp;</span><span class="S8">=</span><span class="S0"> </span><span class="S9">$nLeft</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$nTmpTop</span><span class="S0">&nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$nTop</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$nTmpRight</span><span class="S0">&nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$nRight</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$nTmpBottom</span><span class="S0">&nbsp;</span><span class="S8">=</span><span class="S0"> </span><span class="S9">$nBottom</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; InflateRect</span><span class="S8">(</span><span class="S9">$nTmpLeft</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpTop</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpRight</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpBottom</span><span class="S8">,</span><span class="S0"> </span><span class="S8">-</span><span class="S3">4</span><span class="S8">,</span><span class="S0"> </span><span class="S8">-</span><span class="S3">4</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; DrawFocusRect</span><span class="S8">(</span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpLeft</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpTop</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpRight</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTmpBottom</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br>
<br>
<span class="S0">&nbsp; &nbsp; SelectObject</span><span class="S8">(</span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$hOldBrush</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; DeleteObject</span><span class="S8">(</span><span class="S9">$hBrush</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; SetTextColor</span><span class="S8">(</span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nClrTxt</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; SetBkColor</span><span class="S8">(</span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nClrBk</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S3">1</span><br>
<span class="S5">EndFunc</span><br>
<br>
<br>
<span class="S1">; Some graphic / windows functions</span><br>
<span class="S5">Func</span><span class="S0"> CreateSolidBrush</span><span class="S8">(</span><span class="S9">$nColor</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$hBrush</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllCall</span><span class="S8">(</span><span class="S7">"gdi32.dll"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"hwnd"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"CreateSolidBrush"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"int"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nColor</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S9">$hBrush</span><span class="S8">[</span><span class="S3">0</span><span class="S8">]</span><br>
<span class="S5">EndFunc</span><br>
<br>
<br>
<span class="S5">Func</span><span class="S0"> GetSysColor</span><span class="S8">(</span><span class="S9">$nIndex</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$nColor</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllCall</span><span class="S8">(</span><span class="S7">"user32.dll"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"int"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"GetSysColor"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"int"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nIndex</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S9">$nColor</span><span class="S8">[</span><span class="S3">0</span><span class="S8">]</span><br>
<span class="S5">EndFunc</span><br>
<br>
<br>
<span class="S5">Func</span><span class="S0"> GetSysColorBrush</span><span class="S8">(</span><span class="S9">$nIndex</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$hBrush</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllCall</span><span class="S8">(</span><span class="S7">"user32.dll"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"hwnd"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"GetSysColorBrush"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"int"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nIndex</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S9">$hBrush</span><span class="S8">[</span><span class="S3">0</span><span class="S8">]</span><br>
<span class="S5">EndFunc</span><br>
<br>
<br>
<span class="S5">Func</span><span class="S0"> DrawFrameControl</span><span class="S8">(</span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nLeft</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTop</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nRight</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nBottom</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nType</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nState</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> &nbsp; </span><span class="S9">$stRect</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllStructCreate</span><span class="S8">(</span><span class="S7">"int;int;int;int"</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllStructSetData</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">,</span><span class="S0"> </span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nLeft</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllStructSetData</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">,</span><span class="S0"> </span><span class="S3">2</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTop</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllStructSetData</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">,</span><span class="S0"> </span><span class="S3">3</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nRight</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllStructSetData</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">,</span><span class="S0"> </span><span class="S3">4</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nBottom</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllCall</span><span class="S8">(</span><span class="S7">"user32.dll"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"int"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"DrawFrameControl"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"hwnd"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"ptr"</span><span class="S8">,</span><span class="S0"> </span><span class="S4">DllStructGetPtr</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">),</span><span class="S0"> </span><span class="S7">"int"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nType</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"int"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nState</span><span class="S8">)</span><br>
<br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$stRect</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br>
<span class="S5">EndFunc</span><br>
<br>
<br>
<span class="S5">Func</span><span class="S0"> DrawFocusRect</span><span class="S8">(</span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nLeft</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTop</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nRight</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nBottom</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> &nbsp; </span><span class="S9">$stRect</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllStructCreate</span><span class="S8">(</span><span class="S7">"int;int;int;int"</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllStructSetData</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">,</span><span class="S0"> </span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nLeft</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllStructSetData</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">,</span><span class="S0"> </span><span class="S3">2</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTop</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllStructSetData</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">,</span><span class="S0"> </span><span class="S3">3</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nRight</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllStructSetData</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">,</span><span class="S0"> </span><span class="S3">4</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nBottom</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllCall</span><span class="S8">(</span><span class="S7">"user32.dll"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"int"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"DrawFocusRect"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"hwnd"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"ptr"</span><span class="S8">,</span><span class="S0"> </span><span class="S4">DllStructGetPtr</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">))</span><br>
<span class="S0">&nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$stRect</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br>
<span class="S5">EndFunc</span><br>
<br>
<br>
<span class="S5">Func</span><span class="S0"> DrawText</span><span class="S8">(</span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$sText</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nLeft</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTop</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nRight</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nBottom</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nFormat</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$nLen</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">StringLen</span><span class="S8">(</span><span class="S9">$sText</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$stRect</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllStructCreate</span><span class="S8">(</span><span class="S7">"int;int;int;int"</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllStructSetData</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">,</span><span class="S0"> </span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nLeft</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllStructSetData</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">,</span><span class="S0"> </span><span class="S3">2</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTop</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllStructSetData</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">,</span><span class="S0"> </span><span class="S3">3</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nRight</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllStructSetData</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">,</span><span class="S0"> </span><span class="S3">4</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nBottom</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$stText</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllStructCreate</span><span class="S8">(</span><span class="S7">"char[260]"</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllStructSetData</span><span class="S8">(</span><span class="S9">$stText</span><span class="S8">,</span><span class="S0"> </span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$sText</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllCall</span><span class="S8">(</span><span class="S7">"user32.dll"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"int"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"DrawText"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"hwnd"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"ptr"</span><span class="S8">,</span><span class="S0"> </span><span class="S4">DllStructGetPtr</span><span class="S8">(</span><span class="S9">$stText</span><span class="S8">),</span><span class="S0"> </span><span class="S7">"int"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nLen</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"ptr"</span><span class="S8">,</span><span class="S0"> </span><span class="S4">DllStructGetPtr</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">),</span><span class="S0"> </span><span class="S7">"int"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nFormat</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$stRect</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$stText</span><span class="S0">&nbsp;</span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br>
<span class="S5">EndFunc</span><br>
<br>
<br>
<span class="S5">Func</span><span class="S0"> FillRect</span><span class="S8">(</span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nLeft</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTop</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nRight</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nBottom</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$hBrush</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> &nbsp; </span><span class="S9">$stRect</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllStructCreate</span><span class="S8">(</span><span class="S7">"int;int;int;int"</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllStructSetData</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">,</span><span class="S0"> </span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nLeft</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllStructSetData</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">,</span><span class="S0"> </span><span class="S3">2</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTop</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllStructSetData</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">,</span><span class="S0"> </span><span class="S3">3</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nRight</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllStructSetData</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">,</span><span class="S0"> </span><span class="S3">4</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nBottom</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllCall</span><span class="S8">(</span><span class="S7">"user32.dll"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"int"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"FillRect"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"hwnd"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"ptr"</span><span class="S8">,</span><span class="S0"> </span><span class="S4">DllStructGetPtr</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">),</span><span class="S0"> </span><span class="S7">"hwnd"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$hBrush</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$stRect</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br>
<span class="S5">EndFunc</span><br>
<br>
<br>
<span class="S5">Func</span><span class="S0"> FrameRect</span><span class="S8">(</span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nLeft</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTop</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nRight</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nBottom</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$hBrush</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> &nbsp; </span><span class="S9">$stRect</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllStructCreate</span><span class="S8">(</span><span class="S7">"int;int;int;int"</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllStructSetData</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">,</span><span class="S0"> </span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nLeft</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllStructSetData</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">,</span><span class="S0"> </span><span class="S3">2</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTop</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllStructSetData</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">,</span><span class="S0"> </span><span class="S3">3</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nRight</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllStructSetData</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">,</span><span class="S0"> </span><span class="S3">4</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nBottom</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllCall</span><span class="S8">(</span><span class="S7">"user32.dll"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"int"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"FrameRect"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"hwnd"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"ptr"</span><span class="S8">,</span><span class="S0"> </span><span class="S4">DllStructGetPtr</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">),</span><span class="S0"> </span><span class="S7">"hwnd"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$hBrush</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$stRect</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br>
<span class="S5">EndFunc</span><br>
<br>
<br>
<span class="S5">Func</span><span class="S0"> InflateRect</span><span class="S8">(</span><span class="S5">ByRef</span><span class="S0"> </span><span class="S9">$nLeft</span><span class="S8">,</span><span class="S0"> </span><span class="S5">ByRef</span><span class="S0"> </span><span class="S9">$nTop</span><span class="S8">,</span><span class="S0"> </span><span class="S5">ByRef</span><span class="S0"> </span><span class="S9">$nRight</span><span class="S8">,</span><span class="S0"> </span><span class="S5">ByRef</span><span class="S0"> </span><span class="S9">$nBottom</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nX</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nY</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> &nbsp; </span><span class="S9">$stRect</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllStructCreate</span><span class="S8">(</span><span class="S7">"int;int;int;int"</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllStructSetData</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">,</span><span class="S0"> </span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nLeft</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllStructSetData</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">,</span><span class="S0"> </span><span class="S3">2</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nTop</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllStructSetData</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">,</span><span class="S0"> </span><span class="S3">3</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nRight</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllStructSetData</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">,</span><span class="S0"> </span><span class="S3">4</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nBottom</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllCall</span><span class="S8">(</span><span class="S7">"user32.dll"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"int"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"InflateRect"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"ptr"</span><span class="S8">,</span><span class="S0"> </span><span class="S4">DllStructGetPtr</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">),</span><span class="S0"> </span><span class="S7">"int"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nX</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"int"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nY</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$nLeft</span><span class="S0">&nbsp; &nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllStructGetData</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">,</span><span class="S0"> </span><span class="S3">1</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$nTop</span><span class="S0">&nbsp; &nbsp;&nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllStructGetData</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">,</span><span class="S0"> </span><span class="S3">2</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$nRight</span><span class="S0">&nbsp;&nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllStructGetData</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">,</span><span class="S0"> </span><span class="S3">3</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$nBottom</span><span class="S0">&nbsp; &nbsp; </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllStructGetData</span><span class="S8">(</span><span class="S9">$stRect</span><span class="S8">,</span><span class="S0"> </span><span class="S3">4</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$stRect</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br>
<span class="S5">EndFunc</span><br>
<br>
<br>
<span class="S5">Func</span><span class="S0"> SetBkColor</span><span class="S8">(</span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nColor</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$nOldColor</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllCall</span><span class="S8">(</span><span class="S7">"gdi32.dll"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"int"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"SetBkColor"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"hwnd"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"int"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nColor</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S9">$nOldColor</span><span class="S8">[</span><span class="S3">0</span><span class="S8">]</span><br>
<span class="S5">EndFunc</span><br>
<br>
<br>
<span class="S5">Func</span><span class="S0"> SetTextColor</span><span class="S8">(</span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nColor</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$nOldColor</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllCall</span><span class="S8">(</span><span class="S7">"gdi32.dll"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"int"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"SetTextColor"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"hwnd"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"int"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nColor</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S9">$nOldColor</span><span class="S8">[</span><span class="S3">0</span><span class="S8">]</span><br>
<span class="S5">EndFunc</span><br>
<br>
<br>
<span class="S5">Func</span><span class="S0"> SelectObject</span><span class="S8">(</span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$hObj</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$hOldObj</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllCall</span><span class="S8">(</span><span class="S7">"gdi32.dll"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"hwnd"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"SelectObject"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"hwnd"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$hDC</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"hwnd"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$hObj</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S9">$hOldObj</span><span class="S8">[</span><span class="S3">0</span><span class="S8">]</span><br>
<span class="S5">EndFunc</span><br>
<br>
<br>
<span class="S5">Func</span><span class="S0"> DeleteObject</span><span class="S8">(</span><span class="S9">$hObj</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$nResult</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllCall</span><span class="S8">(</span><span class="S7">"gdi32.dll"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"hwnd"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"DeleteObject"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"hwnd"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$hObj</span><span class="S8">)</span><br>
<span class="S5">EndFunc</span><br>
<br>
<br>
<span class="S5">Func</span><span class="S0"> GetWindowLong</span><span class="S8">(</span><span class="S9">$hWnd</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nIndex</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$nVal</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllCall</span><span class="S8">(</span><span class="S7">"user32.dll"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"int"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"GetWindowLong"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"hwnd"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$hWnd</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"int"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$nIndex</span><span class="S8">)</span><br>
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S9">$nVal</span><span class="S8">[</span><span class="S3">0</span><span class="S8">]</span><br>
<span class="S5">EndFunc</span><br>
<span class="S0"></span></span><br>
<p>&nbsp;</p>

</body>

<!-- Mirrored from www.autoitscript.com/autoit3/docs/functions/GUIRegisterMsg.htm by HTTrack Website Copier/3.x [XR&CO'2006], Mon, 21 May 2007 15:28:59 GMT -->
</html>
