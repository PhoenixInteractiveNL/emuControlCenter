<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<!-- Mirrored from www.autoitscript.com/autoit3/docs/intro/autoit_on_vista.htm by HTTrack Website Copier/3.x [XR&CO'2006], Mon, 21 May 2007 15:29:01 GMT -->
<head>
  <title>AutoIt on Windows Vista</title>
  <meta http-equiv="Content-Type"
 content="text/html; charset=iso-8859-1">
  <link href="../css/default.css" rel="stylesheet" type="text/css"></head>
<body>
<h1>AutoIt on Windows Vista </h1>
<p>Windows Vista brings new security features to restrict the running of files that require administrative rights. Even administrator users will be prompted every time an executable runs which will perform some administrative operation (such as writing to the registry key HKEY_LOCAL_MACHINE or writing to the C:\Windows directory). This is called <strong>User Account Control (UAC)</strong>.</p>
<p>By default AutoIt scripts run with standard user permissions but AutoIt has been coded to allow the script writer the option to &quot;tag&quot; a script in order to tell AutoIt if it needs to run with full admin rights or not. </p>
<p>To force a script to attempt to run itself with administrative rights add the <strong>#requireadmin</strong> directive at the top of your script as follows:</p>
<p class="codebox">
; This script requires full Administrative rights<br>
  #requireadmin<br>
  <br>
  MsgBox(0, "Info", "This script has admin rights! ")</p>
<p class="code">&nbsp;</p>
<p>When the script runs AutoIt will check if it already has full admin rights and if not it will cause the operating system to prompt the user for permission as shown in &quot;UAC Prompts&quot;. If permission is not given by the user the script will terminate. </p>
<p>&nbsp;</p>
<h2>UAC Prompts  </h2>
<p>The prompts that Vista will show when launching a program with administrative rights are shown below. The type of prompt displayed will depend on if the user is a &quot;standard user&quot; or an &quot;adminstrator user&quot; (remember even administrators need to get elevated permissions to perform admin operations). Note: The prompts shown are for the digitally signed version of AutoIt - all release versions are signed but beta versions may not be and will give a warning as shown in &quot;Compiled Scripts&quot; below. </p>
<p>&nbsp;</p>
<p><strong>Standard User Prompt</strong></p>
<p><img src="../images/autoit_standarduser_uac_signed.png" width="439" height="427"></p>
<p>A standard user must select a user name and enter a password in order to continue and run the script with elevated rights. </p>
<p>&nbsp;</p>
<p><strong>Administrator User Prompt</strong></p>
<p><img src="../images/autoit_uac_signed.png" width="439" height="241"></p>
<p>As the user is already an administrator and just requires elevation the user needs only to click on continue - no password is needed. </p>
<p>&nbsp;</p>
<h2>Compiled Scripts </h2>
<p>Compiled scripts (and possibly beta versions of AutoIt) are <strong>not </strong>digitally signed and will give a more serious looking warning as shown:</p>
<p><img src="../images/compiled_uac_unsigned.png" width="460" height="369"> </p>
<p>The user must click on <strong>Allow</strong> to continue (or enter a password if they are a standard user).</p>
<p> If you have your own Authenticode signature you may sign your compiled scripts yourself.</p>
<p>&nbsp;</p>
<p><strong>Important: Whether AutoIt or a compiled script is signed or not, you should only run scripts from sources you trust!</strong></p>
<p><strong><u>Even signed code can be malicious!</u> </strong></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
</body>

<!-- Mirrored from www.autoitscript.com/autoit3/docs/intro/autoit_on_vista.htm by HTTrack Website Copier/3.x [XR&CO'2006], Mon, 21 May 2007 15:29:03 GMT -->
</html>